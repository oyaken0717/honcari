<!doctype html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Honcari | グループ詳細</title>
<link href="../static/css/bootstrap.css" th:href="@{/css/bootstrap.css}" rel="stylesheet">
<link rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/slick.css">
<link rel="stylesheet" type="text/css" href="/css/slick-theme.css">
<link rel="shortcut icon" href="/img/favicon.ico">
 </head>
 <body >
<main role="main">

<div th:if="${complete}" id="flash" class="alert alert-success alert-dismissible fade show flash" role="alert">
  <strong th:if="${registerGroup}">グループを作成しました!!</strong>
	  <div th:if="${inviteGroup}">
		  <span th:if="${inviteGroup}" th:each="user:${userList}">
		  	<strong th:text="${user.name} + さん"></strong>&nbsp;&nbsp;
		  </span>
		  <span>をこのグループに招待しました。相手が承認するまでお待ちください。</span>
	  </div>
  <strong th:if="${joinGroup}">グループに参加しました!!</strong>
 	  <button type="button" class="close hideMe" data-dismiss="alert" aria-label="Close">
	    <span aria-hidden="true">&times;</span>
	  </button>
</div>

<nav th:replace="header::frag_header(1)"></nav>

  <div class="container content-wrapper">
    <div class="row align-items-center my-3">
      <div class="col-lg-6">
        <img class="img-fluid rounded-lg ml-auto mr-3 mb-4 mb-lg-0 d-block w-75" th:src="${group.groupImage}" alt="">
      </div>
      <div class="col-lg-6">
        <h1 class="font-weight-light" th:text="${group.name}">group name</h1>
        <span th:if="${group.groupStatus} == 1">(非公開グループ)</span><br th:if="${group.groupStatus} == 1">
        <a class="btn btn-warning mt-2" th:href="@{'/group/join?groupId=' + ${group.id}}" role="button" th:if="${b}==false" onclick="return confirm('このグループに参加します。よろしいですか？')">このグループに参加する &raquo;</a><br th:if="${b}==false">
        <a class="btn btn-secondary mt-2" th:href="@{'/group/reject_invite_group?groupId=' + ${group.id}}" role="button" th:if="${groupRelation}" onclick="return confirm('このグループに参加しません。よろしいですか？')">このグループに参加しない &raquo;</a>
  	    <small th:if="${hasRequestOwnerAdmin}">※オーナー権限委任依頼に返答しない限りこのグループを抜けることができません</small> 
      </div>
    </div>

	  <div class="m-3">
		  <a class="btn btn-sm btn-outline-secondary" th:href="@{${session.returnParam}}" role="button" >&laquo; 戻る</a>
          <a class="btn btn-sm btn-primary float-right" th:href="@{'/group/out_group?id=' + ${group.id}}" role="button" th:if="${b==true and owner == null and hasRequestOwnerAdmin == null}" onclick="return confirm('本当にこのグループから抜けますか？')">このグループを抜ける &raquo;</a>
		  <a class="btn btn-sm btn-outline-secondary float-right ml-4" th:href="@{/group/to_edit_group(groupId=${group.id})}" th:if="${userId}==${group.ownerUserId}">Edit</a>
		  <a class="btn btn-sm btn-warning float-right" th:href="@{'/group/to_invite_group?id=' + ${group.id}}" role="button" th:if="${userId}==${group.ownerUserId}">このグループに招待する</a>
	  </div>
	<!-- タブ・メニュー -->
	    <ul class="nav nav-tabs nav-justified justify-content-center">
  			<li class="nav-item">
    			<a class="nav-link text-dark active" href="#about-group" data-toggle="tab">このグループについて</a>
 	 		</li>
 	 		<li class="nav-item">
   				 <a class="nav-link text-dark" href="#book-list" data-toggle="tab">シェアされている本</a>
  			</li>
  			<li class="nav-item">
   				 <a class="nav-link text-dark" href="#discussion" data-toggle="tab">ディスカッション</a>
  			</li>
    	</ul>
    	
    	<div class="tab-content content-wrapper">
			<div class="tab-pane tab-content fade show active" id="about-group" th:unless="${group}==null">
				<div class="row">
			      <div class="col-md-7">
			        <h3>グループ概要</h3>
			        <p class="text-muted" th:text="${group.description}">Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
			      </div>
			      <div class="col-md-5">
				      <div>
				        <h3>オーナー</h3>
				        <div class="text-muted">
							<a class="text-muted a-link" th:if="${userId != group.ownerUserId}" th:href="@{/user/show_user_page(userId=${group.ownerUserId})}" th:text="${group.ownerUser.name}"></a>
							<a class="text-muted a-link" th:if="${userId == group.ownerUserId}" th:href="@{/user/show_mypage}" th:text="${group.ownerUser.name}"></a>
						</div>
					  </div>
					  <hr>
					  <div>
						<h3>メンバー</h3>
				        <div class="text-muted" th:each="user:${group.userList}">
							<a class="text-muted a-link" th:href="${userId == user.userId} ? '/user/show_mypage' : '/user/show_user_page?userId=' + ${user.userId}" th:text="${user.name}"></a>
 						</div>
					  </div>
			      </div>

		      </div>
			</div>
			
			<div class="tab-pane tab-content fade" id="book-list" th:if="${#lists.size(ownedBookInfoList)}==0">
			  <div class="text-center" style="margin:40px">シェアされている本はありません</div>
			</div>
			<div class="tab-pane tab-content fade" id="book-list" th:unless="${#lists.size(ownedBookInfoList)}==0">
					<div class="row">
						<div class="col-md-12">
							<div class="row">
								<div class="shadow-sm ml-4 mb-4 p-0 bg-white col-md-2" th:each="ownedBookInfo: ${ownedBookInfoList}">
									<div th:if="${ownedBookInfo.bookStatus} != 3">
										<img class="bd-placeholder-img thumbnail" src="" th:src="@{${ownedBookInfo.book.thumbnailPath}}">
									</div>
									<div th:if="${ownedBookInfo.bookStatus} == 3" class="now-lending">
										<img class="bd-placeholder-img thumbnail" style="opacity: 0.5" src="" th:src="@{${ownedBookInfo.book.thumbnailPath}}">
									</div>
									<div class="p-3" style="text-align:left">
										<div class="mb-3 div-book-title">
											<span class="card-text book-title" th:text="${ownedBookInfo.book.title}"></span>
										</div>
										<span class="book-owner">所有者：<a class="a-link" th:href="@{/user/show_user_page(userId=${ownedBookInfo.userId})}" th:text="${ownedBookInfo.user.name}"></a></span><br>			
									</div>
								</div>
							</div>
						</div>
					</div>
			</div>
			
			<div class="tab-pane tab-content fade" id="discussion">
				<div class="text-center" style="margin:40px">coming soon...</div>
			</div>
		</div>
		
		
  </div> 

</main>

<!-- コンテンツ -->
<footer th:replace="footer::footer"></footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="/js/slick.min.js"></script>
<script type="text/javascript" src="/js/slick_option.js"></script>
<script src="../static/js/group_detail.js" th:src="@{/js/group_detail.js}"></script>
  </body>
<style>
.tab-content{
  /** ５行以上で省略 */
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 10;
  -webkit-box-orient: vertical;
}
</style>
</html>