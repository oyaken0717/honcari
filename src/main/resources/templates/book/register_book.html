<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="_csrf" th:content="${_csrf.token}"/>
	<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
	<title>Honcari -気軽に本をどこへでも-</title>
	<link href="../static/css/bootstrap.css" th:href="@{/css/bootstrap.css}" rel="stylesheet">
	<link rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" rel="stylesheet" type="text/css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://ajaxzip3.github.io/ajaxzip3.js" charset="UTF-8"></script>
	<script src="../static/js/bootstrap.min.js" th:src="@{/js/bootstrap.min.js}"></script>
	<script	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="../static/js/bootstrap.js" th:src="@{/js/bootstrap.js}"></script>
	<script src="../static/js/book.js" th:src="@{/js/book.js}"></script>
</body>
</head>
<body>
<nav th:replace="header::frag_header(1)"></nav>
	<div id="flash" class="alert alert-success alert-dismissible fade show flash" role="alert">
  		<span id="register-success"></span>
	</div>
	<div class="container content-wrapper">
	<section class="register-book-imagde">
	<h2 class="section-heading" style="padding-top: 50px">マイブックに本を登録しよう</h2>
	<p class="section-description">書籍名もしくはISBNコードにて検索</p>
			<div class="search-book-for-add row justify-content-center">
			<form th:action="@{/book/search_books}" method="POST" th:object="${searchGoogleBookForm}">
				<p th:errors="*{searchWord}" style="color:red">　</p>
				<span class="form-inline">
	    		<input type="text" name="searchWord" class="form-control" placeholder="登録する本を検索..." th:field="*{searchWord}">　
				<button class="btn btn-warning my-2 my-sm-0">検索</button>
				</span>
			</form>
			</div>
			</section>
		<div class="row">
		<div class="table-responsive">
		<br>
			<table id="book-list" th:if="${volumeInfoList}">
				<tr class="mt-3 mb-3">
					<th width="20%">書籍サムネイル</th><th width="20%">著者</th><th width="20%">タイトル</th><th width="20%">出版日</th><th width="20%">登録</th>
				</tr>
				<tr th:each="item : ${volumeInfoList}" id="register-tr">
					<td th:if="${item.volumeInfo.imageLinks}" style="padding:10px 0 10px 0"><img class="book-img" th:src="${item.volumeInfo.imageLinks.smallThumbnail}"></td>
					<td th:unless="${item.volumeInfo.imageLinks}"><img class="book-img">No Photo</td>
					<td th:if="${item.volumeInfo.authors}"><span th:text="${item.volumeInfo.authors[0]}"></span></td>
					<td th:unless="${item.volumeInfo.authors}"><span>ー</span></td>
					<td th:if="${item.volumeInfo.title}"><span th:text="${item.volumeInfo.title}"></span></td>
					<td th:unless="${item.volumeInfo.title}"><span>ー</span></td>
					<td th:if="${item.volumeInfo.publishedDate}"><span th:text="${item.volumeInfo.publishedDate}"></span></td>
					<td th:unless="${item.volumeInfo.publishedDate}"><span>ー</span></td>
					<td><button id="register-btn" class="btn btn-warning register-btn" data-toggle="modal" data-target="#book-register-form">登録</button>
					<input th:if="${item.volumeInfo.industryIdentifiers}" type="hidden" class="isbn-id" th:value="${item.volumeInfo.industryIdentifiers[0].identifier}">
					<input th:unless="${item.volumeInfo.industryIdentifiers}" type="hidden" class="isbn-id" th:value="ー">
					<input th:if="${item.volumeInfo.title}" type="hidden" class="title" th:value="${item.volumeInfo.title}">
					<input th:unless="${item.volumeInfo.title}" type="hidden" class="title" th:value="ー">
					<input th:if="${item.volumeInfo.authors}" type="hidden" class="author" th:value="${item.volumeInfo.authors[0]}">
					<input th:unless="${item.volumeInfo.authors}" type="hidden" class="author" th:value="ー">
					<input th:if="${item.volumeInfo.publishedDate}" type="hidden" class="published-date" th:value="${item.volumeInfo.publishedDate}">
					<input th:unless="${item.volumeInfo.publishedDate}" type="hidden" class="published-date" th:value="ー">
					<input th:if="${item.volumeInfo.description}" type="hidden" class="description" th:value="${item.volumeInfo.description}">
					<input th:unless="${item.volumeInfo.description}" type="hidden" class="description" th:value="ー">
					<input th:if="${item.volumeInfo.pageCount}" type="hidden" class="page-count" th:value="${item.volumeInfo.pageCount}">
					<input th:unless="${item.volumeInfo.pageCount}" type="hidden" class="page-count" th:value="ー">
					<input th:if="${item.volumeInfo.imageLinks}" type="hidden" class="thumbnail-path" th:value="${item.volumeInfo.imageLinks.smallThumbnail}">
					<input th:unless="${item.volumeInfo.imageLinks}" type="hidden" class="thumbnail-path" th:value="NoPhoto">
					</td>
				</tr>
			</table>
			<div class="pager">
				<ul class="pagination">
					<li class="active"><a class="register-book-paging" th:if="${nowPageNumber} AND ${nowPageNumber} != 1" th:href="@{'/book/search_books?searchWord=' + ${searchWord} + '&pageNumber=' + ${nowPageNumber - 1}}">前へ</a></li>
					<li class="active"><a class="register-book-paging" th:if="${nowPageNumber}" th:href="@{'/book/search_books?searchWord=' + ${searchWord} + '&pageNumber=' + ${nowPageNumber + 1}}">次へ</a></li>
				</ul>
			</div>
		</div>
	</div>				
	
<!-- モーダル -->
<div class="modal fade" id="book-register-form" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">書籍情報を登録する</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<form id="book-data">
				<div class="modal-body">
					<select name="categoryId" id="register-category-id">
						<option th:each="category : ${categoryList}" th:text="${category.name}" th:value="${category.categoryId}"></option>
					</select>
				</div>
				<div class="modal-body">
					<textarea id="register-comment" name="comment" rows="4" cols="30" placeholder="コメント" class="form-control"></textarea>
				</div>
				<div class="modal-body">
					<label for="book-status-0">
						<input id="book-status-0" type="radio" class="book-status-register" name="bookStatus" th:value="0">&nbsp;貸出不可&nbsp;&nbsp;&nbsp;
					</label>
					<label for="book-status-1">
						<input id="book-status-1" type="radio" class="book-status-register" name="bookStatus" th:value="1" checked>&nbsp;貸出可
					</label>
				</div>
				<div class="modal-footer">
					<button id="book-register-button" type="reset" data-dismiss="modal" class="btn btn-warning">登録する</button>
					<button type="button" class="btn btn-secondary" data-dismiss="modal">閉じる</button>
  				</div>
  				<div id="book-request-parameter"></div>
  				</form>
  		</div>
  	</div>	
</div>
</div>
<footer th:replace="footer::footer"></footer>
</body>
</html>